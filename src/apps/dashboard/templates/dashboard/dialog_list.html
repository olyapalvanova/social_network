{% extends 'dashboard/base.html' %}

{% block body %}
    {% for channel in channels %}
        <main role="main" id="channel-wrapper-{{ channel.id }}">
        <div class="my-3 p-3 bg-white rounded shadow-sm">
        <div class="media text-muted pt-3">
        <p class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray">
                        <strong class="d-block text-gray-dark">
                <img width="100" height="100" src="{{ channel.logo }}" class="rounded float-left" alt="Responsive image" width="100%" height="100%">

        {% for u in channel.users.all %}
            {% if u != request.user %}
                <a href="{% url 'dashboard:dialog' channel.id %}"
                   style="color:#000000; text-decoration:none">{{ u }}
                    &nbsp; </a>
            {% endif %}
        {% endfor %}
             </strong>
            <p><button class="btn btn-secondary" name="block" data-channel-id={{ channel.id }} role="button">
                {% if channel.blocked %}
                    Unblock
                {% else %}
                    Block
                {% endif %}
                </button></p>
            </p>
           </div>
        </div>
        </main>
    {% endfor %}
    {% if is_blocked %}
        <a href="{% url 'dashboard:dialogs' %}" style="color: #999999"
           class="button">Show dialogs</a>
    {% else %}
        <a href="{% url 'dashboard:dialogs_block' %}" style="color: #999999"
           class="button">Show blocked dialogs</a>
    {% endif %}

    <script>
        $("button[name='block']").click(function () {
            var channelId = $(this).data("channel-id");
            $.ajax({
                type: 'post',
                url: '{% url 'dashboard:dialog_block_switch' 0 %}'.replace('0', channelId),
                success: function (responseChannelBlock) {
                    $('#channel-wrapper-' + channelId).remove()
                }
            })
    })
    </script>
{% endblock %}